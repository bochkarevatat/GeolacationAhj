(()=>{"use strict";class t{constructor(t){this.parentEl=t,this.message=null,this.formInput=null,this.modalInput=null,this.addMessage=this.addMessage.bind(this)}static get markup(){return'\n      <div class="container-tl">\n      <div class="list"></div>\n      <div class="input-form">\n      <form class="form">\n        <input class="form-input" name="input" type="text">\n        <div class="icon-audio"></div>\n        <div class="icon-video"></div>\n      </form>\n      </div>\n      </div> \n      '}static get containerTl(){return".container-tl"}static get list(){return".list"}static get formInput(){return".form-input"}static get form(){return".form"}bindToDOM(){this.parentEl.innerHTML=t.markup,this.containerTl=this.parentEl.querySelector(t.containerTl),this.list=this.parentEl.querySelector(t.list),this.form=this.parentEl.querySelector(t.form),this.formInput=this.parentEl.querySelector(t.formInput),this.form.addEventListener("submit",this.addMessage)}addMessage(t){t.preventDefault(),this.elem=document.createElement("div"),this.elem.classList.add("message"),this.list.appendChild(this.elem),this.letter=document.createElement("div"),this.letter.classList.add("letter"),this.elem.appendChild(this.letter),this.letter.textContent=t.target.input.value,this.data=document.createElement("div"),this.data.classList.add("data"),this.data.textContent=`${(new Date).toLocaleString()}`,this.elem.appendChild(this.data),this.location=document.createElement("div"),this.location.classList.add("location"),this.getLocation(),this.resetInput()}resetInput(){this.formInput.value=""}getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((t=>{const{latitude:e,longitude:n}=t.coords;this.showCoordinate(e.toFixed(4),n.toFixed(4))}),(t=>{this.showModal(),console.error(t)}))}showCoordinate(t,e){this.location.textContent=`[${t}, ${e}]`,this.elem.insertAdjacentElement("beforeEnd",this.location),this.locationIcon=document.createElement("div"),this.locationIcon.classList.add("locationIcon"),this.location.insertAdjacentElement("afterEnd",this.locationIcon)}showModal(){const t=document.createElement("div");t.classList.add("modal"),t.innerHTML='\n        <div class="modal-text">Что-то пошло не так  \n        <p>Извините, но мы не можем определить ваше местоположение, \n        пожалуйста, дайте нам разрешение на использование геолокации, \n        либо введите координаты вручную.\n        </p>\n        <p class="instruction">Широта и долгота через запятую</p>\n        <form class="modal-form">\n          <input class="modal-input" name="modal" type="text">\n          <div class="buttons">\n          <button type="reset" class="cancel">Отмена</button>\n          <button type="submit" class="submit">OK</button>\n          </div>\n        </form>\n        </div>\n      ',this.parentEl.appendChild(t);const e=this.parentEl.querySelector(".modal-input");console.log(e),this.parentEl.querySelector(".modal-form").addEventListener("reset",(t=>{t.preventDefault(),this.hideModal()})),this.parentEl.querySelector(".modal-form").addEventListener("submit",(t=>{t.preventDefault();let e=this.checkValidity(t.target.modal.value);if(console.log(e),e){e=e[0].split(",");const t=e[0].trim(),n=e[1].trim();this.hideModal(),this.showCoordinate(t,n)}else alert("Неверный формат данных")}))}hideModal(){this.parentEl.querySelector(".modal").remove(),this.resetInput()}checkValidity(t){return t.match(/^\[?\d+\.\d+,\s?\-?\d+\.\d+\]?$/gm)}}const e=document.querySelector("#container");console.log(e);new t(e).bindToDOM()})();